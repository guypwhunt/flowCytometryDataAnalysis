ymin = predicted - std.error,
ymax = predicted + std.error
),
fill = "lightgrey",
alpha = 0.5
) +  # error band
geom_point(
data = scaledDF,
# adding the raw data (scaled values)
aes(x = medianValue, y = survivalFromVisit, colour = fastSlow)
) +
labs(x = "Median GPR32 Abundance", y = "Survival from Visit in Years") +
guides(color = guide_legend(title = "Progression")) +
scale_colour_viridis_d() +
theme_minimal()
)
pred.mm <-
ggpredict(fit, terms = c("GPR32_median.2"))  # this gives overall predictions for the model
# Plot the predictions
(
ggplot(pred.mm) +
geom_line(aes(x = x, y = predicted)) +          # slope
geom_ribbon(
aes(
x = x,
ymin = predicted - std.error,
ymax = predicted + std.error
),
fill = "lightgrey",
alpha = 0.5
) +  # error band
geom_point(
data = scaledDF,
# adding the raw data (scaled values)
aes(x = medianValue, y = survivalFromVisit, colour = fastSlow)
) +
labs(x = "Median GPR32 Abundance", y = "Survival from Visit in Years") +
guides(color = guide_legend(title = "Progression")) +
scale_colour_viridis_d() +
theme_minimal()
)
(
ggplot(pred.mm) +
geom_line(aes(x = x, y = predicted)) +          # slope
geom_ribbon(
aes(
x = x,
ymin = predicted - std.error,
ymax = predicted + std.error
),
fill = "lightgrey",
alpha = 0.5
) +  # error band
geom_point(
data = scaledDF,
# adding the raw data (scaled values)
aes(x = GPR32_median.2, y = survivalFromVisit, colour = fastSlow)
) +
labs(x = "Median GPR32 Abundance", y = "Survival from Visit in Years") +
guides(color = guide_legend(title = "Progression")) +
scale_colour_viridis_d() +
theme_minimal()
)
(
ggplot(pred.mm) +
geom_line(aes(x = x, y = predicted)) +          # slope
geom_ribbon(
aes(
x = x,
ymin = predicted - std.error,
ymax = predicted + std.error
),
fill = "lightgrey",
alpha = 0.5
) +  # error band
geom_point(
data = scaledDF,
# adding the raw data (scaled values)
aes(x = GPR32_median.2, y = survivalFromVisit, colour = ethnicity)
) +
labs(x = "Median GPR32 Abundance", y = "Survival from Visit in Years") +
guides(color = guide_legend(title = "Ethnicity")) +
scale_colour_viridis_d() +
theme_minimal()
)
(
ggplot(pred.mm) +
geom_line(aes(x = x, y = predicted)) +          # slope
geom_ribbon(
aes(
x = x,
ymin = predicted - std.error,
ymax = predicted + std.error
),
fill = "lightgrey",
alpha = 0.5
) +  # error band
geom_point(
data = scaledDF,
# adding the raw data (scaled values)
aes(x = GPR32_median.2, y = survivalFromVisit, colour = BulbarLimb)
) +
labs(x = "Median GPR32 Abundance", y = "Survival from Visit in Years") +
guides(color = guide_legend(title = "Site of Onset")) +
scale_colour_viridis_d() +
theme_minimal()
)
(
ggplot(data = scaledDF,
# adding the raw data (scaled values)
aes(x = ageAtVisit, y = survivalFromVisit)) +
geom_point() +
labs(x = "Age at Visit", y = "Survival from Visit in Years") +
geom_smooth(method = "lm") +
theme_minimal()
)
(
ggplot(scaledDF, aes(x = alsfrsR, y = survivalFromVisit)) +
geom_point() +
labs(x = "ALSFRSR", y = "Survival from Visit in Years") +
geom_smooth(method = "lm") +
theme_minimal()
)
(
ggplot(
scaledDF,
aes(x = timeFromOnsetToVisitInYears, y = survivalFromVisit)
) +
geom_point() +
labs(x = "Time from Onset to Visit", y = "Survival from Visit in Years") +
geom_smooth(method = "lm") +
theme_minimal()
)
boxplot(scaledDF$survivalFromVisit ~ scaledDF$gender)
boxplot(scaledDF$survivalFromVisit ~ scaledDF$ethnicity)
boxplot(scaledDF$survivalFromVisit ~ scaledDF$BulbarLimb)
medianResultsAllClusters <- read.csv("data/medianValues/medianValues.csv")
head(medianResultsAllClusters)
clusterName
markersOrCell
medianResultsAllClusters <- medianResultsAllClusters[
medianResultsAllClusters$clusterName == clusterName &
medianResultsAllClusters$markersOrCell == markersOrCell]
medianResultsAllClusters
medianResultsAllClusters <- read.csv("data/medianValues/medianValues.csv")
medianResultsAllClusters <- medianResultsAllClusters[
medianResultsAllClusters$clusterName == clusterName &
medianResultsAllClusters$markersOrCell == markersOrCell,]
head(medianResultsAllClusters)
medianResultsAllClusters <- read.csv("data/medianValues/medianValues.csv")
medianResultsAllClusters$clusterName == clusterName
clusterName
medianResultsAllClusters$clusterName
clusterName <- "clusters_flowsom"
medianResultsAllClusters$clusterName == clusterName
medianResultsAllClusters$markersOrCell == markersOrCell
medianResultsAllClusters <- medianResultsAllClusters[
medianResultsAllClusters$clusterName == clusterName &
medianResultsAllClusters$markersOrCell == markersOrCell,]
head(medianResultsAllClusters)
unique(medianResultsAllClusters$panel)
head(monocytesResults)
monocytesResults <-
read.csv("data/monocytes/clusteringOutput/meta_clusters_flowsomClustersMedians.csv")
colnames(monocytesResults)
assign(clusterName, NULL)
medianResultsIndividualClusters <-
data.frame(fileName = as.character(),
clusterName = as.character(),
clusterId = as.character(),
markersOrCell = as.character(),
GPR32_median = as.double()
)
x <-
read.csv("data/monocytes/clusteringOutput/meta_clusters_flowsomClustersMedians.csv")
clusterName
x$clusterName <- clusterName
x$markersOrCell <- markersOrCell
x$clusterId <- x[, clusterName]
x[, clusterName]
try(source("R/01_functions.R"))
try(source("R/00_datasets.R"))
loadlibraries()
clusterNames <- clusterColumns
markersOrCells <- markersOrCellsClassification
clusterName <- clusterNames[1]
markersOrCell <- markersOrCells[3]
clusterName
clusterName <- clusterNames[3]
markersOrCell <- markersOrCells[1]
clusterName
markersOrCell
medianResultsAllClusters <- read.csv("data/medianValues/medianValues.csv")
medianResultsAllClusters <- medianResultsAllClusters[
medianResultsAllClusters$clusterName == clusterName &
medianResultsAllClusters$markersOrCell == markersOrCell,]
head(medianResultsAllClusters)
medianResultsIndividualClusters <-
data.frame(fileName = as.character(),
clusterName = as.character(),
clusterId = as.character(),
markersOrCell = as.character(),
GPR32_median = as.double()
)
unique(medianResultsAllClusters$panel)
panel <- "monocytes"
panel
x <-
read.csv(paste0("data/", panel, "/clusteringOutput/",clusterName, markersOrCell, "Medians.csv"))
x$clusterName <- clusterName
x$markersOrCell <- markersOrCell
x$clusterId <- x[, clusterName]
x <- x[, c("fileName", "clusterName", "clusterId", "markersOrCell", "GPR32_median")]
medianResultsIndividualClusters <- rbind(medianResultsIndividualClusters, x)
medianResultsIndividualClusters <-
data.frame(fileName = as.character(),
clusterName = as.character(),
clusterId = as.character(),
markersOrCell = as.character(),
GPR32_median = as.double()
)
for (panel in unique(medianResultsAllClusters$panel)){
x <-
read.csv(paste0("data/", panel, "/clusteringOutput/",clusterName, markersOrCell, "Medians.csv"))
x$clusterName <- clusterName
x$markersOrCell <- markersOrCell
x$clusterId <- x[, clusterName]
x <- x[, c("fileName", "clusterName", "clusterId", "markersOrCell", "GPR32_median")]
medianResultsIndividualClusters <- rbind(medianResultsIndividualClusters, x)
}
medianResultsIndividualClusters <-
data.frame(fileName = as.character(),
clusterName = as.character(),
clusterId = as.character(),
markersOrCell = as.character(),
GPR32_median = as.double()
)
for (panel in unique(medianResultsAllClusters$panel)){
x <-
read.csv(paste0("data/", panel, "/clusteringOutput/",clusterName, markersOrCell, "Medians.csv"))
x$clusterName <- clusterName
x$markersOrCell <- markersOrCell
x$clusterId <- x[, clusterName]
x <- x[, c("fileName", "clusterName", "clusterId", "markersOrCell", "GPR32_median")]
medianResultsIndividualClusters <- rbind(medianResultsIndividualClusters, x)
}
head(medianResultsIndividualClusters)
head(medianResultsIndividualClusters)
medianResultsIndividualClusters <-
data.frame(fileName = as.character(),
panel =as.character(),
clusterName = as.character(),
clusterId = as.character(),
markersOrCell = as.character(),
GPR32_median = as.double()
)
for (panel in unique(medianResultsAllClusters$panel)){
x <-
read.csv(paste0("data/", panel, "/clusteringOutput/",clusterName, markersOrCell, "Medians.csv"))
x$panel <- panel
x$clusterName <- clusterName
x$markersOrCell <- markersOrCell
x$clusterId <- x[, clusterName]
x <- x[, colnames(medianResultsIndividualClusters)]
medianResultsIndividualClusters <- rbind(medianResultsIndividualClusters, x)
}
head(medianResultsIndividualClusters)
head(medianResultsIndividualClusters)
das <- length(unique(medianResultsIndividualClusters$fileName))
das
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', fileName] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-02', fileName] <- 'BLT00074-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-04', fileName] <- 'BLT00075-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00092-06', fileName] <- 'BLT00092-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-06', fileName] <- 'BLT00186-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-09', fileName] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-03', fileName] <- 'BLT00211-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-06', fileName] <- 'BLT00211-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-06', fileName] <- 'BLT00211-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-02', fileName] <- 'BLT00214-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-05', fileName] <- 'BLT00214-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00230-02', fileName] <- 'BLT00230-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-07', fileName] <- 'BLT00243-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-04', fileName] <- 'BLT00244-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-06', fileName] <- 'BLT00244-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-06', fileName] <- 'BLT00244-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00254-05', fileName] <- 'BLT00254-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00254-07', fileName] <- 'BLT00254-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-04', fileName] <- 'BLT00265-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-04', fileName] <- 'BLT00265-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-08', fileName] <- 'BLT00265-8'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00271-04', fileName] <- 'BLT00271-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00271-07', fileName] <- 'BLT00271-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-06', fileName] <- 'BLT00274-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-03', fileName] <- 'BLT00285-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-05', fileName] <- 'BLT00285-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-05', fileName] <- 'BLT00285-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-04', fileName] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-06', fileName] <- 'BLT00286-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297_02', fileName] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT0244_02', fileName] <- 'BLT00244_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'QS_024-02', fileName] <- 'QS_024-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-4', fileName] <- 'BLT00074_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-6', fileName] <- 'BLT00075_06'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-2', fileName] <- 'BLT00186_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-9', fileName] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00261-2', fileName] <- 'BLT00261_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', fileName] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-4_R1', fileName] <- 'BLT00075-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-3 ', fileName] <- 'BLT00211-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', fileName] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT000214-5', fileName] <- 'BLT00214-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00057-4', fileName] <- 'BLT00057_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00092_4', fileName] <- 'BLT00092_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00198_2', fileName] <- 'BLT00198_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-4', fileName] <- 'BLT00214_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00230-4', fileName] <- 'BLT00230_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00242-2', fileName] <- 'BLT00242_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-5', fileName] <- 'BLT00243_05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-2', fileName] <- 'BLT00274_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-5', fileName] <- 'BLT00243_05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-2', fileName] <- 'BLT00274_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-4', fileName] <- 'BLT00274-05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-5', fileName] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', fileName] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS033_02', fileName] <- 'BAS_033_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', fileName] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-4', fileName] <- 'BLT00074_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-6', fileName] <- 'BLT00075_06'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186_2', fileName] <- 'BLT00186_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS00101', fileName] <- 'BAS101'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-9', fileName] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00261_02', fileName] <- 'BLT00261_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-5', fileName] <- 'BLT00274-05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-4', fileName] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', fileName] <- 'BLT00297_2'
medianResultsIndividualClusters
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-02', 'fileName'] <- 'BLT00074-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-04', 'fileName'] <- 'BLT00075-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00092-06', 'fileName'] <- 'BLT00092-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-06', 'fileName'] <- 'BLT00186-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-09', 'fileName'] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-03', 'fileName'] <- 'BLT00211-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-06', 'fileName'] <- 'BLT00211-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-06', 'fileName'] <- 'BLT00211-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-02', 'fileName'] <- 'BLT00214-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-05', 'fileName'] <- 'BLT00214-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00230-02', 'fileName'] <- 'BLT00230-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-07', 'fileName'] <- 'BLT00243-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-04', 'fileName'] <- 'BLT00244-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-06', 'fileName'] <- 'BLT00244-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-06', 'fileName'] <- 'BLT00244-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00254-05', 'fileName'] <- 'BLT00254-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00254-07', 'fileName'] <- 'BLT00254-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-04', 'fileName'] <- 'BLT00265-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-04', 'fileName'] <- 'BLT00265-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-08', 'fileName'] <- 'BLT00265-8'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00271-04', 'fileName'] <- 'BLT00271-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00271-07', 'fileName'] <- 'BLT00271-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-06', 'fileName'] <- 'BLT00274-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-03', 'fileName'] <- 'BLT00285-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-05', 'fileName'] <- 'BLT00285-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-05', 'fileName'] <- 'BLT00285-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-04', 'fileName'] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-06', 'fileName'] <- 'BLT00286-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297_02', 'fileName'] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT0244_02', 'fileName'] <- 'BLT00244_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'QS_024-02', 'fileName'] <- 'QS_024-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-4', 'fileName'] <- 'BLT00074_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-6', 'fileName'] <- 'BLT00075_06'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-2', 'fileName'] <- 'BLT00186_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-9', 'fileName'] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00261-2', 'fileName'] <- 'BLT00261_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', 'fileName'] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-4_R1', 'fileName'] <- 'BLT00075-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-3 ', 'fileName'] <- 'BLT00211-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', 'fileName'] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT000214-5', 'fileName'] <- 'BLT00214-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00057-4', 'fileName'] <- 'BLT00057_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00092_4', 'fileName'] <- 'BLT00092_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00198_2', 'fileName'] <- 'BLT00198_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-4', 'fileName'] <- 'BLT00214_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00230-4', 'fileName'] <- 'BLT00230_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00242-2', 'fileName'] <- 'BLT00242_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-5', 'fileName'] <- 'BLT00243_05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-2', 'fileName'] <- 'BLT00274_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-5', 'fileName'] <- 'BLT00243_05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-2', 'fileName'] <- 'BLT00274_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-4', 'fileName'] <- 'BLT00274-05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-5', 'fileName'] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS033_02', 'fileName'] <- 'BAS_033_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-4', 'fileName'] <- 'BLT00074_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-6', 'fileName'] <- 'BLT00075_06'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186_2', 'fileName'] <- 'BLT00186_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS00101', 'fileName'] <- 'BAS101'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-9', 'fileName'] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00261_02', 'fileName'] <- 'BLT00261_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-5', 'fileName'] <- 'BLT00274-05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-4', 'fileName'] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', 'fileName'] <- 'BLT00297_2'
length(unique(medianResultsIndividualClusters$fileName))
head(medianResultsIndividualClusters)
paste(medianResultsIndividualClusters$panel,
medianResultsIndividualClusters$clusterName,
medianResultsIndividualClusters$clusterId,
sep = "_")
medianResultsIndividualClusters$clusterId <- paste(medianResultsIndividualClusters$panel,
medianResultsIndividualClusters$clusterName,
medianResultsIndividualClusters$clusterId,
sep = "_")
colnames(medianResultsIndividualClusters)
medianResultsIndividualClusters <-
data.frame(fileName = as.character(),
panel =as.character(),
clusterName = as.character(),
clusterId = as.character(),
markersOrCell = as.character(),
GPR32_median = as.double()
)
for (panel in unique(medianResultsAllClusters$panel)){
x <-
read.csv(paste0("data/", panel, "/clusteringOutput/",clusterName, markersOrCell, "Medians.csv"))
x$panel <- panel
x$clusterName <- clusterName
x$markersOrCell <- markersOrCell
x$clusterId <- x[, clusterName]
x <- x[, colnames(medianResultsIndividualClusters)]
medianResultsIndividualClusters <- rbind(medianResultsIndividualClusters, x)
}
das <- length(unique(medianResultsIndividualClusters$fileName))
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-02', 'fileName'] <- 'BLT00074-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-04', 'fileName'] <- 'BLT00075-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00092-06', 'fileName'] <- 'BLT00092-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-06', 'fileName'] <- 'BLT00186-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-09', 'fileName'] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-03', 'fileName'] <- 'BLT00211-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-06', 'fileName'] <- 'BLT00211-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-06', 'fileName'] <- 'BLT00211-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-02', 'fileName'] <- 'BLT00214-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-05', 'fileName'] <- 'BLT00214-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00230-02', 'fileName'] <- 'BLT00230-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-07', 'fileName'] <- 'BLT00243-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-04', 'fileName'] <- 'BLT00244-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-06', 'fileName'] <- 'BLT00244-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00244-06', 'fileName'] <- 'BLT00244-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00254-05', 'fileName'] <- 'BLT00254-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00254-07', 'fileName'] <- 'BLT00254-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-04', 'fileName'] <- 'BLT00265-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-04', 'fileName'] <- 'BLT00265-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00265-08', 'fileName'] <- 'BLT00265-8'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00271-04', 'fileName'] <- 'BLT00271-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00271-07', 'fileName'] <- 'BLT00271-7'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-06', 'fileName'] <- 'BLT00274-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-03', 'fileName'] <- 'BLT00285-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-05', 'fileName'] <- 'BLT00285-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00285-05', 'fileName'] <- 'BLT00285-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-04', 'fileName'] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-06', 'fileName'] <- 'BLT00286-6'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297_02', 'fileName'] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT0244_02', 'fileName'] <- 'BLT00244_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'QS_024-02', 'fileName'] <- 'QS_024-2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-4', 'fileName'] <- 'BLT00074_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-6', 'fileName'] <- 'BLT00075_06'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-2', 'fileName'] <- 'BLT00186_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-9', 'fileName'] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00261-2', 'fileName'] <- 'BLT00261_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', 'fileName'] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-4_R1', 'fileName'] <- 'BLT00075-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00211-3 ', 'fileName'] <- 'BLT00211-3'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', 'fileName'] <- 'BLT00297_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT000214-5', 'fileName'] <- 'BLT00214-5'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00057-4', 'fileName'] <- 'BLT00057_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00092_4', 'fileName'] <- 'BLT00092_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00198_2', 'fileName'] <- 'BLT00198_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00214-4', 'fileName'] <- 'BLT00214_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00230-4', 'fileName'] <- 'BLT00230_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00242-2', 'fileName'] <- 'BLT00242_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-5', 'fileName'] <- 'BLT00243_05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-2', 'fileName'] <- 'BLT00274_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00243-5', 'fileName'] <- 'BLT00243_05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-2', 'fileName'] <- 'BLT00274_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-4', 'fileName'] <- 'BLT00274-05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-5', 'fileName'] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS033_02', 'fileName'] <- 'BAS_033_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS057_02', 'fileName'] <- 'BAS_057_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00074-4', 'fileName'] <- 'BLT00074_04'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00075-6', 'fileName'] <- 'BLT00075_06'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186_2', 'fileName'] <- 'BLT00186_02'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BAS00101', 'fileName'] <- 'BAS101'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00186-9', 'fileName'] <- 'BLT00186_9'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00261_02', 'fileName'] <- 'BLT00261_2'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00274-5', 'fileName'] <- 'BLT00274-05'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00286-4', 'fileName'] <- 'BLT000286-4'
medianResultsIndividualClusters[medianResultsIndividualClusters$fileName ==  'BLT00297-2', 'fileName'] <- 'BLT00297_2'
head(medianResultsIndividualClusters)
medianResultsIndividualClusters$clusterId <- paste(medianResultsIndividualClusters$panel,
medianResultsIndividualClusters$markersOrCell,
medianResultsIndividualClusters$clusterName,
medianResultsIndividualClusters$clusterId,
sep = "_")
reshape(
medianResultsIndividualClusters,
idvar = "fileName",
timevar = "clusterId",
direction = "wide"
)
