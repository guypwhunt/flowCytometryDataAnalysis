"Switched Memory B cells",
"Late Memory B cells"
)
c(
"Unswitched Memory B Cells",
"Unswitched Memory B cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells",
"Unswitched Memory B Cells",
"Unswitched Memory B Cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells"
)
bCellClusterNames <- c(
"Unswitched Memory B Cells",
"Unswitched Memory B cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells",
"Unswitched Memory B Cells",
"Unswitched Memory B Cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells"
)
bulbarVsLimbOnsetFileNames <-
c(
"bulbarVsLimbOnsetOneDifferentialAbundanceStatistics.csv",
"bulbarVsLimbOnsetOneDifferentialStatesStatistics.csv",
"bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics.csv",
"bulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics.csv"
)
directories <- c("bCells", "monocytes")
### B Cells ####
bCellClusterNames <- c(
"Unswitched Memory B Cells",
"Unswitched Memory B cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells",
"Unswitched Memory B Cells",
"Unswitched Memory B Cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells"
)
# Load B Cell Bulbar Vs Limb Onset Differential States For All B Cells
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics.csv"
)
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, "typeOfCells"] <-
"B Cells"
# Load B Cell Bulbar Vs Limb Onset Differential Abundance For All B Cells
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics.csv"
)
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, "typeOfCells"] <-
"B Cells"
# Load B Cell Bulbar Vs Limb Onset Differential States For Clusters
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetOneDifferentialStatesStatistics.csv"
)
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics[, "typeOfCells"] <- bCellClusterNames
# Load B Cell Bulbar Vs Limb Onset Differential Abundance For Clusters
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetOneDifferentialAbundanceStatistics.csv"
)
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, "typeOfCells"] <- bCellClusterNames
bCellClusterNames <- c(
"Unswitched Memory B Cells",
"Unswitched Memory B cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells"
)
2 * bCellClusterNames
c(bCellClusterNames,bCellClusterNames)
gc()
bulbarVsLimbOnsetFileNames <-
c(
"bulbarVsLimbOnsetOneDifferentialAbundanceStatistics.csv",
"bulbarVsLimbOnsetOneDifferentialStatesStatistics.csv",
"bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics.csv",
"bulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics.csv"
)
directories <- c("bCells", "monocytes")
### B Cells ####
bCellClusterNames <- c(
"Unswitched Memory B Cells",
"Unswitched Memory B cells and Follicular B Cells",
"Unknown",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells"
)
# Load B Cell Bulbar Vs Limb Onset Differential States For All B Cells
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics.csv"
)
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, "typeOfCells"] <-
"B Cells"
# Load B Cell Bulbar Vs Limb Onset Differential Abundance For All B Cells
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics.csv"
)
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, "typeOfCells"] <-
"B Cells"
# Load B Cell Bulbar Vs Limb Onset Differential States For Clusters
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetOneDifferentialStatesStatistics.csv"
)
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics[, "typeOfCells"] <- c(bCellClusterNames,bCellClusterNames)
# Load B Cell Bulbar Vs Limb Onset Differential Abundance For Clusters
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics <-
read.csv(
"data/bCells/differentialTestingOutputs/bulbarVsLimbOnsetOneDifferentialAbundanceStatistics.csv"
)
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, "panel"] <-
"bCells"
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, "typeOfCells"] <- bCellClusterNames
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics[, colnames(bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics)]] <-
NA
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, colnames(bCellBCellbulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)]] <-
NA
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, colnames(bCellbulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)]] <-
NA
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics
colnames(bCellbulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)
]
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)]] <-
NA
bCellbulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, colnames(bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(bCellbulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)]] <-
NA
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(bCellCulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)]] <-
NA
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)]] <-
NA
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics)]] <-
NA
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics[, colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics)]] <-
NA
bCellsBulbarVsLimbOnsetDf <-
rbind(
bCellbulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics,
bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics
)
bCellsBulbarVsLimbOnsetDf <-
rbind(
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics,
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics
)
bCellsBulbarVsLimbOnsetDf <-
rbind(
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics,
bCellBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics
)
bCellsBulbarVsLimbOnsetDf <-
rbind(
bCellsBulbarVsLimbOnsetDf,
bCellBulbarVsLimbOnsetOneDifferentialAbundanceStatistics
)
bCellsBulbarVsLimbOnsetDf <-
rbind(
bCellsBulbarVsLimbOnsetDf,
bCellBulbarVsLimbOnsetOneDifferentialStatesStatistics
)
bCellsBulbarVsLimbOnsetDf
monocyteClusterNames <- c(
"Non-Classical Monocytes",
"Classical Monocytes",
"CD11b+ Classical Monocytes",
"CD11b+ Interstitial Macrophages",
"CD11b+ Non-Classical Monocytes",
"Interstitial Macrophages"
)
# Load B Cell Bulbar Vs Limb Onset Differential States For All B Cells
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics <-
read.csv(
"data/monocytes/differentialTestingOutputs/bulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics.csv"
)
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, "panel"] <-
"monocytes"
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, "typeOfCells"] <-
"Monocytes"
# Load B Cell Bulbar Vs Limb Onset Differential Abundance For All B Cells
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics <-
read.csv(
"data/monocytes/differentialTestingOutputs/bulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics.csv"
)
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, "panel"] <-
"monocytes"
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, "typeOfCells"] <-
"Monocytes"
# Load B Cell Bulbar Vs Limb Onset Differential States For Clusters
monocyteBulbarVsLimbOnsetOneDifferentialStatesStatistics <-
read.csv(
"data/monocytes/differentialTestingOutputs/bulbarVsLimbOnsetOneDifferentialStatesStatistics.csv"
)
monocyteBulbarVsLimbOnsetOneDifferentialStatesStatistics[, "panel"] <-
"monocytes"
monocyteBulbarVsLimbOnsetOneDifferentialStatesStatistics[, "typeOfCells"] <- c(monocyteClusterNames,monocyteClusterNames)
# Load B Cell Bulbar Vs Limb Onset Differential Abundance For Clusters
monocyteBulbarVsLimbOnsetOneDifferentialAbundanceStatistics <-
read.csv(
"data/monocytes/differentialTestingOutputs/bulbarVsLimbOnsetOneDifferentialAbundanceStatistics.csv"
)
monocyteBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, "panel"] <-
"monocytes"
monocyteBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, "typeOfCells"] <- monocyteClusterNames
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics[, colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)]] <-
NA
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics[, colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)]] <-
NA
monocyteBulbarVsLimbOnsetOneDifferentialAbundanceStatistics[, colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics)[!colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics) %in%
colnames(monocyteBulbarVsLimbOnsetOneDifferentialAbundanceStatistics)]] <-
NA
monocyteBulbarVsLimbOnsetOneDifferentialStatesStatistics[, colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics)[!colnames(monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics) %in%
colnames(monocyteBulbarVsLimbOnsetOneDifferentialStatesStatistics)]] <-
NA
monocytesBulbarVsLimbOnsetDf <-
rbind(
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialAbundanceStatistics,
monocyteBulbarVsLimbOnsetVisitOneOneClusterDifferentialStatesStatistics
)
monocytesBulbarVsLimbOnsetDf <-
rbind(
monocytesBulbarVsLimbOnsetDf,
monocyteBulbarVsLimbOnsetOneDifferentialAbundanceStatistics
)
monocytesBulbarVsLimbOnsetDf <-
rbind(
monocytesBulbarVsLimbOnsetDf,
monocyteBulbarVsLimbOnsetOneDifferentialStatesStatistics
)
bCellBulbarVsLimbOnsetDf
bCellsBulbarVsLimbOnsetDf
df <- rbind(monocytesBulbarVsLimbOnsetDf, bCellsBulbarVsLimbOnsetDf)
p.adjust(df[, "p_val"], method = "bonferroni")
p.adjust(df[, "p_val"], method = "bonferroni") < 5
p.adjust(df[, "p_val"], method = "bonferroni")
p.adjust(df[, "p_val"], method = "bonferroni") < 0.05
p.adjust(df[, "p_val"], method = "fdr")
df[, "bonferroni_adjusted_p_val"] <- p.adjust(df[, "p_val"], method = "bonferroni")
df[, "fdr_adjusted_p_val"] <- p.adjust(df[, "p_val"], method = "fdr")
df
# https://bioconductor.org/packages/devel/bioc/vignettes/diffcyt/inst/doc/diffcyt_workflow.html
try(source("R/03_functions.R"))
loadlibraries()
# variables
directoryName <- "bCells"
columnNames <-
c(
"fileName",
"GPR32...AF488.A",
"IgD...PerCP.Cy5.5.A",
"CD24...BV605.A",
"CD27...BV650.A",
"FPRL1...AF647.A"
)
clusterName <- "clusters_flowsom"
samplesContributionToClustersThreshold <- 10
differentialAbundanceThreshold <- 0.05
# Read experiment data
experimentInfo <- read.csv("data/metadata/metadata.csv")
experimentInfo <-
experimentInfo[order(experimentInfo[, "sample_id"]),]
experimentInfo[, "group_id"] <- NA
experimentInfo
table(experimentInfo[, 1)
table(experimentInfo[, 1])
numberOfVisits <- data.frame(table(experimentInfo[, 1]))
numberOfVisits
patientsWithThreeVisits <- numberOfVisits$Var1[numberOfVisits$Freq==3]
patientsWithThreeVisits
experimentInfo[, 1] %in% patientsWithThreeVisits
experimentInfo[experimentInfo[, 1] %in% patientsWithThreeVisits,]
threeVisitsExperimentInfo <- experimentInfo[experimentInfo[, 1] %in% patientsWithThreeVisits,]
head(threeVisitsExperimentInfo)
nrow(threeVisitsExperimentInfo)
threeVisitsExperimentInfo <-
threeVisitsExperimentInfo[order(threeVisitsExperimentInfo[, "sample_id"]),]
directories <- c("bCells", "monocytes", "tCells", "senescence")
fileNames <- c("clusters_flowsomvisitVisits1, 3AllCellsDifferentialStatesStatistics.csv",
"clusters_flowsomvisitVisits1, 3ClustersDifferentialStatesStatistics.csv")
paste0("/data/", directories, "/differentialTestingOutputs/", fileNames)
filePaths <- paste0("/data/", directories, "/differentialTestingOutputs/", fileNames)
length(filePaths)
directories <- c("bCells", "monocytes", "tCells", "senescence")
fileNames <- c("clusters_flowsomvisitVisits1, 3AllCellsDifferentialStatesStatistics.csv",
"clusters_flowsomvisitVisits1, 3ClustersDifferentialStatesStatistics.csv")
filePaths <- c()
for (file in fileNames) {
filePaths <- append(fileNames, paste0("/data/", directories, "/differentialTestingOutputs/", file))
}
length(filePaths)
filePaths
filePaths <- c()
length(fileNames)
directories <- c("bCells", "monocytes", "tCells", "senescence")
fileNames <- c("clusters_flowsomvisitVisits1, 3AllCellsDifferentialStatesStatistics.csv",
"clusters_flowsomvisitVisits1, 3ClustersDifferentialStatesStatistics.csv")
filePaths <- c()
for (file in fileNames) {
filePaths <- append(fileNames, paste0("/data/", directories, "/differentialTestingOutputs/", file))
}
length(filePaths)
filePaths
directories <- c("bCells", "monocytes", "tCells", "senescence")
fileNames <- c("clusters_flowsomvisitVisits1, 3AllCellsDifferentialStatesStatistics.csv",
"clusters_flowsomvisitVisits1, 3ClustersDifferentialStatesStatistics.csv")
filePaths <- c()
for (file in fileNames) {
filePaths <- append(filePaths, paste0("/data/", directories, "/differentialTestingOutputs/", file))
}
length(filePaths)
names(fileNames) <- c("allCells", "clusters")
fileNames
grepl("AllCells", file, fixed = TRUE)
file <- fileNames[1]
file
grepl("AllCells", file, fixed = TRUE)
file
names(file) == "allCells"
# Define if it is Differential States or Differential Abundance Aanlaysis
DA <- FALSE
# Define Directories and files
directories <- c("bCells", "monocytes", "tCells", "senescence")
fileNames <- c("clusters_flowsomvisitVisits1, 3AllCellsDifferentialStatesStatistics.csv",
"clusters_flowsomvisitVisits1, 3ClustersDifferentialStatesStatistics.csv")
names(fileNames) <- c("allCells", "clusters")
rep(bCellClusterNames, replicateValue)
# Define if it is Differential States or Differential Abundance Aanlaysis
DA <- FALSE
# Define Directories and files
directories <- c("bCells", "monocytes", "tCells", "senescence")
fileNames <- c("clusters_flowsomvisitVisits1, 3AllCellsDifferentialStatesStatistics.csv",
"clusters_flowsomvisitVisits1, 3ClustersDifferentialStatesStatistics.csv")
names(fileNames) <- c("allCells", "clusters")
if (DA) {
replicateValue <- 1
} else {
replicateValue <- 2
}
### Define Cluster Names ###
bCellClusterNames <- c(
"Unswitched Memory B Cells",
"Unswitched Memory B cells",
"Naive B Cells",
"Follicular B Cells",
"Switched Memory B Cells",
"Immature B Cells",
"Switched Memory B Cells",
"Late Memory B Cells"
)
monocyteClusterNames <- c(
"Non-Classical Monocytes",
"Classical Monocytes",
"CD11b+ Classical Monocytes",
"CD11b+ Intermediate Monocytes",
"CD11b+ Non-Classical Monocytes",
"Intermediate Monocytes"
)
tCellClusterNames <- c(
'Memory T Helper Cells',
'Memory T Helper Cells',
'Memory T Helper Cells',
'Memory T Helper Cells',
'Memory CD8+ T Cells',
'Unknown T Cells',
'Naive CD8+ T Cells',
'Memory T Helper Cells',
'Memory T Helper Cells',
'Naive T Helper Cells',
'Naive T Helper Cells',
'Naive T Helper Cells',
'Naive T Helper Cells',
'Memory T Regulatory Cells',
'Naive T Helper Cells',
'Naive T Helper Cells',
'Memory T Helper Cells',
'Memory T Helper Cells',
'Naive T Regulatory Cells',
'Naive CD8+ T Cells',
'Memory CD8+ T Cells',
'Memory CD8+ T Cells',
'Memory T Helper Cells',
'Memory T Helper Cells',
'Memory CD8+ T Cells',
'Naive CD8+ T Cells',
'Memory CD8+ T Cells',
'Memory CD8+ T Cells',
'Memory CD8+ T Cells'
)
senescentClusterNames <- c(
'Unknown Senescent T Cells',
'Unknown Senescent T Cells',
'Unknown Senescent T Cells',
'Unknown Senescent T Cells',
'Unknown Senescent T Cells',
'Non-Viral Associated Senescent CD8+ T Cells',
'Non-Viral Associated Senescent CD8+ T Cells',
'Viral Associated Senescent CD8+ T Cells',
'Unknown Senescent T Cells',
'Intermediate Senescent 2',
'Viral Associated Senescent CD8+ T Cells',
'Early Senescent',
'Early Senescent',
'Viral Associated Senescent CD8+ T Cells',
'Early Senescent',
'Intermediate Senescent 2',
'Viral Associated Senescent CD8+ T Cells',
'Viral Associated Senescent CD8+ T Cells',
'Intermediate Senescent 2',
'Intermediate Senescent 2',
'Late Senescent',
'Viral Associated Senescent CD8+ T Cells',
'Late Senescent',
'Late Senescent'
)
listOfDfs <- c()
rep(bCellClusterNames, replicateValue)
combinedDf <- data.frame()
combinedDf <- data.frame()
str_replace_all(fileNames, " ", "")
library(stringr)
str_replace_all(fileNames, " ", "")
str_replace_all(str_replace_all(fileNames, " ", ""), ",", "")
str_replace_all(str_replace_all(str_replace_all(fileNames, " ", ""), ",", ""), ".", "")
str_replace_all(str_replace_all(str_replace_all(fileNames, " ", ""), ",", ""), "\\.", "")
getwd()
cellPopulationMarkers <- read.csv(paste0("data/", directoryName, "/clusteringOutput/", clusterName, markersOrCells, ".csv"), row.names = FALSE)
# variables
directoryName <- "tCells"
columnNames <- c("fileName", "CD127.BV510.A", "CD8.BV650.A",
"CD25.BV786.A", "FoxP3.PE.A", "CD45RO.PE.CF595.A",
"CD4.PerCP.Cy5.5.A", "GPR32.AF488.A", "FPRL1.AF647.A")
clusterName <- "clusters_flowsom"
markersOrCells <- c("Clusters","CellPopulations", "Markers")
markersOrCell <- markersOrCells[1]
markersOrCells <- markersOrCells[1]
markersOrCells != "Clusters"
if (markersOrCells != "Clusters") {
cellPopulationMarkers <- read.csv(paste0("data/", directoryName, "/clusteringOutput/", clusterName, markersOrCells, ".csv"), row.names = FALSE)
}
cellPopulationMarkers <- read.csv(paste0("data/", directoryName, "/clusteringOutput/", clusterName, markersOrCells, ".csv"), row.names = FALSE)
markersOrCells
markersOrCells <- c("Clusters","CellPopulations", "Markers")
markersOrCells <- markersOrCells[2]
paste0("data/", directoryName, "/clusteringOutput/", clusterName, markersOrCells, ".csv")
paste0("data/", directoryName, "/clusteringOutput/", clusterName, markersOrCells, ".csv")
cellPopulationMarkers <- read.csv(paste0("data/", directoryName, "/clusteringOutput/", clusterName, markersOrCells, ".csv"), row.names = FALSE)
